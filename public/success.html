<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Success — MindPing</title>

  <!--<script>
    const params = new URLSearchParams(window.location.search);
    const token = params.get("token");

    async function verify() {
      const res = await fetch(`/verify-purchase?token=${token}`);
      const data = await res.json();
  console.log('data',data)
  console.log('token',token)
  
      if (data.paid) {
        localStorage.setItem("mindping_pro", "true");
        window.location.href = "history.html";
      } else {
        alert('handling failed')
      }
    }

    verify();
  </script>-->
<!--  <script>
  const params = new URLSearchParams(window.location.search);

  if (params.get("success") === "true") {
    // Unlock Pro
    localStorage.setItem("mindping_pro", "true");

    // Optional: store purchase date
    localStorage.setItem("mindping_pro_since", new Date().toISOString());

    // Redirect back to app
    setTimeout(() => {
      window.location.href = "/";
    }, 1500);
  }
  else{
    alert('Failef to handle')
  }
</script>-->
<script>
  const params = new URLSearchParams(window.location.search);
  const sessionId = params.get("token");

  if (!sessionId) {
    console.log('Session id missing')
    // No Stripe session → deny unlock
   // window.location.href = "/";
  } else {
    // Save session so it can't be reused easily
    localStorage.setItem("mindping_pro", "true");
    localStorage.setItem("mindping_stripe_session", sessionId);
    setTimeout(() => {
      window.location.href = "/today.html";
    },1200);
  }
</script>

<script>
  // Minimal v1 unlock
localStorage.setItem("mindping_pro", "true");

localStorage.setItem("mindping_paid_at", Date.now());
</script>

  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-50 flex items-center justify-center min-h-screen">
    <div class="bg-white p-6 rounded-2xl shadow text-center space-y-4">
    <h1 class="text-2xl font-bold">Processing payment…</h1>
    <p class="text-gray-500 text-sm">This may take a few seconds.</p>
  </div>
</body>
</html>